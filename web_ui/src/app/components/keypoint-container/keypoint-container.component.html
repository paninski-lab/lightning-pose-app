<!-- this sets the boundary for dragging to be slightly larger than parent component (video or image)
   to allow dragging the keypoint slightly past the edge to allow moving its center to (0,0) or other corners/edges
<div #dragBoundary class="absolute -inset-1"></div>-->
<style>
  .crosshair-element::before,
  .crosshair-element::after {
    content: "";
    position: absolute; /* These will be positioned relative to the .crosshair-element */
    background-color: white; /* Or your desired crosshair color */
    opacity: 0.4;
  }
  .crosshair-element.newKp::before,
  .crosshair-element.newKp::after {
    background-color: rgba(255, 255, 0, 0);
    cursor: none;
  }

  /* Vertical line */
  .crosshair-element::before {
    width: 0.5px;
    height: 100%;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
  }

  /* Horizontal line */
  .crosshair-element::after {
    width: 100%;
    height: 0.5px;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
  }
  .selected {
    border: 0.5px solid yellow;
  }
</style>
<style>
  /* A single element to hold both lines, so we can apply a single mask */
  .crosshair2-wrapper {
    --line-thickness: 0.5px; /* Thickness of the crosshair lines */
    --line-color: grey; /* Color of the crosshair lines */
    --center-circle-radius: 1px; /* Radius of the optional center circle */

    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* Apply the mask to this wrapper */
    mask-image: radial-gradient(
      circle at var(--crosshair-x) var(--crosshair-y),
      transparent var(--center-circle-radius),
      /* Transparent up to radius */ black var(--center-circle-radius)
        /* Opaque from radius onwards */
    );
    /* Ensure the mask covers the entire wrapper */
    -webkit-mask-size: 100% 100%;
    mask-size: 100% 100%;
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    will-change: mask-position, transform; /* Hint for animation */
  }

  .crosshair-horizontal-line,
  .crosshair-vertical-line {
    position: absolute;
    background-color: var(--line-color);
    will-change: transform;
  }

  .crosshair-horizontal-line {
    width: 100%;
    height: var(--line-thickness);
    left: 0;
    transform: translateY(
      calc(var(--crosshair-y) - (var(--line-thickness) / 2))
    );
  }

  .crosshair-vertical-line {
    height: 100%;
    width: var(--line-thickness);
    top: 0;
    transform: translateX(
      calc(var(--crosshair-x) - (var(--line-thickness) / 2))
    );
  }
</style>
<div
  #containerDiv
  class="w-full h-full relative overflow-hidden"
  [class.cursor-none]="newKp() !== null"
  (mouseenter)="handleMouseEnter($event)"
  (mouseleave)="handleMouseLeave($event)"
  (pointermove)="handlePointerMove($event)"
  (mousedown)="handleMouseDown($event)"
  (mouseup)="handleMouseUp($event)"
>
  <!-- Horizontal line -->
  @if (newKp() !== null) {
    <div
      class="crosshair2-wrapper"
      [style.--crosshair-x]="(newKp()?.position())!.x + 'px'"
      [style.--crosshair-y]="(newKp()?.position())!.y + 'px'"
    >
      <div class="crosshair-horizontal-line"></div>
      <!-- Vertical line -->
      <div class="crosshair-vertical-line"></div>
    </div>
  }

  @for (keypoint of keypointModels(); track keypoint.id) {
    @if (keypoint.position() !== null) {
      <div
        [attr.data-tip]="keypoint.hoverText"
        [class.selected]="keypoint.id === selectedKeypoint()"
        [style.transform]="getTransform(keypoint)"
        (click)="handleKeypointClick($event, keypoint)"
        (keydown.enter)="handleKeypointClick($event, keypoint)"
        tabindex="0"
        class="
      h-2 w-2
      rounded-full
      shadow-sm/30
      {{ keypoint.colorClass() }}
      {{ keypoint.id === newKp()?.id ? 'cursor-none z-2' : '' }}
      absolute -top-1 -left-1
      tooltip"
      >
        <!-- top, left position should be negative by 1/2 the height and width -->
        @if (useCrossHairs()) {
          <div
            class="crosshair-element {{
              keypoint.id === newKp()?.id ? 'newKp' : ''
            }}"
          ></div>
        }
      </div>
    }
  }
</div>
